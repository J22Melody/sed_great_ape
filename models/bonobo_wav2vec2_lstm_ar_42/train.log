Requirement already satisfied: scikit-learn in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (1.1.2)
Requirement already satisfied: threadpoolctl>=2.0.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (3.1.0)
Requirement already satisfied: joblib>=1.0.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (1.1.0)
Requirement already satisfied: scipy>=1.3.2 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (1.9.1)
Requirement already satisfied: numpy>=1.17.3 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (1.22.3)
Requirement already satisfied: tensorboard in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (2.10.1)
Requirement already satisfied: numpy>=1.12.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (1.22.3)
Requirement already satisfied: requests<3,>=2.21.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (2.28.1)
Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (1.8.1)
Requirement already satisfied: setuptools>=41.0.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (60.8.1)
Requirement already satisfied: protobuf<3.20,>=3.9.2 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (3.19.4)
Requirement already satisfied: google-auth<3,>=1.6.3 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (2.9.1)
Requirement already satisfied: grpcio>=1.24.3 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (1.47.0)
Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (0.6.1)
Requirement already satisfied: markdown>=2.6.8 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (3.4.1)
Requirement already satisfied: wheel>=0.26 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (0.37.1)
Requirement already satisfied: absl-py>=0.4 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (1.2.0)
Requirement already satisfied: werkzeug>=1.0.1 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (2.1.2)
Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (0.4.6)
Requirement already satisfied: rsa<5,>=3.1.4 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (4.9)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (0.2.8)
Requirement already satisfied: six>=1.9.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (1.16.0)
Requirement already satisfied: cachetools<6.0,>=2.0.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (5.2.0)
Requirement already satisfied: requests-oauthlib>=0.7.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard) (1.3.1)
Requirement already satisfied: importlib-metadata>=4.4 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from markdown>=2.6.8->tensorboard) (4.12.0)
Requirement already satisfied: charset-normalizer<3,>=2 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (2.1.1)
Requirement already satisfied: certifi>=2017.4.17 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (2022.9.14)
Requirement already satisfied: idna<4,>=2.5 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (3.4)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (1.26.12)
Requirement already satisfied: zipp>=0.5 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard) (3.8.0)
Requirement already satisfied: pyasn1<0.5.0,>=0.4.6 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard) (0.4.8)
Requirement already satisfied: oauthlib>=3.0.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard) (3.2.0)
Requirement already satisfied: torch in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (1.12.1)
Requirement already satisfied: torchvision in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (0.13.1)
Requirement already satisfied: torchaudio in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (0.12.1)
Requirement already satisfied: typing-extensions in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torch) (4.0.1)
Requirement already satisfied: requests in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torchvision) (2.28.1)
Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torchvision) (9.0.1)
Requirement already satisfied: numpy in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torchvision) (1.22.3)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (1.26.12)
Requirement already satisfied: idna<4,>=2.5 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (3.4)
Requirement already satisfied: certifi>=2017.4.17 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (2022.9.14)
Requirement already satisfied: charset-normalizer<3,>=2 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (2.1.1)
{'name': 'bonobo_wav2vec2_lstm_ar_42', 'data_path': '/home/cluster/zifjia/data/data_bonobo/wav2vec2_split_42', 'test_only': False, 'balance_weights': True, 'model_type': 'lstm', 'model_autoregressive': True, 'n_embedding': 768, 'd_hid': 1024, 'nlayers': 2, 'batch_size': 1, 'n_epoch': 200, 'lr': 0.0002, 'dropout': 0.2, 'patience': 10, 'step_factor': 0.7, 'seed': 42}
cuda
Reading data ...
train, dev, test number of files: 22, 3, 3.
dev files:  ['1758', '861', '2100']
test files:  ['960', '1398', '852']
data_all: (33867, 769)
train_data_all: (29950, 769)
Labels in train_data_all:  {0: 27185, 1: 100, 2: 230, 3: 90, 4: 131, 5: 473, 6: 70, 7: 878, 8: 0, 9: 0, 10: 38, 11: 205, 12: 129, 13: 19, 14: 124, 15: 90, 16: 148, 17: 32, 18: 8}
--- 0.9920151233673096 seconds ---
LSTM(
  (lstm): LSTM(787, 1024, num_layers=2, dropout=0.2, bidirectional=True)
  (hidden2tag): Linear(in_features=2048, out_features=19, bias=True)
)
Number of parameters: 40073235

Train Epoch: 1 accuracy: 0.38 
 precision: [0.92536677 0.         0.00371747 1.         0.         1.
 0.00335188 0.25093075 0.         0.         0.         0.
 0.         1.         0.         0.         0.         0.
 0.        ] 
 recall: [0.39908038 0.         0.00434783 0.         0.         0.
 0.67142857 0.38382688 1.         1.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.        ] 
 f1: [0.55766018 0.         0.00400802 0.         0.         0.
 0.00667045 0.30346691 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.        ] 
 f1_avg: 0.5151193573335802


Validation Epoch: 1 accuracy: 0.04 
 precision: [1.         1.         1.         1.         1.         1.
 1.         0.03986711 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 recall: [4.05844156e-04 0.00000000e+00 0.00000000e+00 1.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 1.00000000e+00
 1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
 1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
 1.00000000e+00 1.00000000e+00 1.00000000e+00] 
 f1: [8.11359026e-04 0.00000000e+00 0.00000000e+00 1.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 7.66773163e-02
 1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
 1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
 1.00000000e+00 1.00000000e+00 1.00000000e+00] 
 f1_avg: 0.0037934829522944797

New best val score, save model ...
--- 82.54669952392578 seconds ---

Train Epoch: 2 accuracy: 0.28 
 precision: [0.92517829 0.15725806 1.         0.09090909 1.         1.
 1.         0.02686313 1.         1.         1.         0.3
 1.         1.         1.         1.         1.         1.
 0.        ] 
 recall: [0.28155233 0.39       0.         0.3        0.         0.
 0.         0.64578588 1.         1.         0.         0.02926829
 0.         0.         0.         0.         0.         0.
 0.        ] 
 f1: [0.43172204 0.22413793 0.         0.13953488 0.         0.
 0.         0.05158062 1.         1.         0.         0.05333333
 0.         0.         0.         0.         0.         0.
 0.        ] 
 f1_avg: 0.39491007139184753


Validation Epoch: 2 accuracy: 0.57 
 precision: [0.95785953 0.01587302 1.         0.         1.         1.
 1.         0.10150376 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 recall: [0.58116883 0.04545455 0.         1.         0.         0.
 0.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 f1: [0.723415   0.02352941 0.         0.         0.         0.
 0.         0.18430034 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 f1_avg: 0.6654739115547625

New best val score, save model ...
--- 160.01353907585144 seconds ---

Train Epoch: 3 accuracy: 0.54 
 precision: [0.98982852 0.02565147 1.         0.05008347 1.         1.
 1.         0.07856682 1.         1.         0.         0.15
 0.         1.         1.         1.         1.         1.
 0.42857143] 
 recall: [0.55843296 0.63       0.         0.66666667 0.         0.
 0.         0.9715262  1.         1.         0.         0.04390244
 0.         0.         0.         0.         0.         0.
 0.75      ] 
 f1: [0.71403038 0.04929577 0.         0.0931677  0.         0.
 0.         0.14537708 1.         1.         0.         0.06792453
 0.         0.         0.         0.         0.         0.
 0.54545455] 
 f1_avg: 0.6534277096973127


Validation Epoch: 3 accuracy: 0.32 
 precision: [0.99741935 0.02714932 1.         0.         1.         1.
 1.         0.23978202 1.         1.         0.         0.
 0.         1.         1.         1.         1.         1.
 1.        ] 
 recall: [0.31371753 0.13636364 0.         1.         0.         0.
 0.         0.81481481 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 f1: [0.47730781 0.04528302 0.         0.         0.         0.
 0.         0.37052632 1.         1.         0.         0.
 0.         1.         1.         1.         1.         1.
 1.        ] 
 f1_avg: 0.4494818233835929

--- 236.88797783851624 seconds ---

Train Epoch: 4 accuracy: 0.43 
 precision: [0.99450038 0.05321508 0.44117647 0.0118333  1.         1.
 1.         0.13446268 1.         1.         0.00666667 0.08634772
 0.         0.01754386 0.         0.40350877 1.         1.
 0.00837696] 
 recall: [0.43237079 0.96       0.06521739 0.76666667 0.         0.
 0.         0.86788155 1.         1.         0.21052632 0.72195122
 0.         0.05263158 0.         0.51111111 0.         0.
 1.        ] 
 f1: [0.60270741 0.10084034 0.11363636 0.02330687 0.         0.
 0.         0.2328495  1.         1.         0.01292407 0.154247
 0.         0.02631579 0.         0.45098039 0.         0.
 0.01661475] 
 f1_avg: 0.5576191602730767


Validation Epoch: 4 accuracy: 0.74 
 precision: [0.95875252 0.         1.         0.         1.         0.
 1.         0.17850638 1.         1.         0.         0.
 1.         1.         1.         0.         1.         1.
 0.        ] 
 recall: [0.77353896 0.         0.         1.         0.         0.
 0.         0.90740741 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 f1: [0.85624438 0.         0.         0.         0.         0.
 0.         0.29832572 1.         1.         0.         0.
 1.         1.         1.         0.         1.         1.
 0.        ] 
 f1_avg: 0.7904078751307029

New best val score, save model ...
--- 314.1853654384613 seconds ---

Train Epoch: 5 accuracy: 0.67 
 precision: [0.98560701 0.07407407 0.51111111 0.05527994 0.73333333 0.65217391
 1.         0.25801696 1.         1.         0.00821636 0.40780142
 0.1800554  0.         0.23275862 0.0617284  1.         0.0375
 0.00743889] 
 recall: [0.69523634 0.44       0.1        0.86666667 0.08396947 0.06342495
 0.         0.79726651 1.         1.         0.63157895 0.56097561
 0.50387597 0.         0.43548387 0.66666667 0.         0.28125
 0.875     ] 
 f1: [0.81534048 0.12680115 0.16727273 0.10393071 0.15068493 0.11560694
 0.         0.38986355 1.         1.         0.0162217  0.47227926
 0.26530612 0.         0.30337079 0.11299435 0.         0.06617647
 0.01475237] 
 f1_avg: 0.7620681422080628


Validation Epoch: 5 accuracy: 0.53 
 precision: [0.9828869  0.         1.         0.         1.         1.
 1.         0.10475267 1.         1.         1.         0.
 0.         0.         1.         1.         1.         1.
 0.        ] 
 recall: [0.53612013 0.         0.         1.         0.         0.
 0.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 f1: [0.69380252 0.         0.         0.         0.         0.
 0.         0.18964004 1.         1.         1.         0.
 0.         0.         1.         1.         1.         1.
 0.        ] 
 f1_avg: 0.6383802714234341

--- 391.0417129993439 seconds ---

Train Epoch: 6 accuracy: 0.50 
 precision: [0.9943426  0.0299328  0.46808511 0.03693315 0.36986301 0.1627907
 0.66666667 0.16064442 1.         1.         0.00626959 0.02093301
 0.02768166 0.01447068 0.05287356 0.00217865 0.15517241 0.03947368
 0.00656814] 
 recall: [0.51075961 0.98       0.09565217 0.87777778 0.41221374 0.04439746
 0.08571429 0.79498861 1.         1.         0.05263158 0.17073171
 0.0620155  1.         0.18548387 0.01111111 0.12162162 0.09375
 1.        ] 
 f1: [0.67486452 0.05809129 0.15884477 0.0708838  0.3898917  0.06976744
 0.15189873 0.26727934 1.         1.         0.01120448 0.03729355
 0.03827751 0.02852853 0.0822898  0.00364299 0.13636364 0.05555556
 0.01305057] 
 f1_avg: 0.6267259243844511


Validation Epoch: 6 accuracy: 0.49 
 precision: [0.99269481 1.         0.05882353 0.         1.         0.
 1.         0.09917355 1.         1.         0.         1.
 1.         1.         1.         1.         1.         1.
 0.        ] 
 recall: [0.4963474  0.         0.02702703 1.         0.         0.
 0.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 f1: [0.66179654 0.         0.03703704 0.         0.         0.
 0.         0.18045113 1.         1.         0.         1.
 1.         1.         1.         1.         1.         1.
 0.        ] 
 f1_avg: 0.6094190992035234

--- 467.9223098754883 seconds ---

Train Epoch: 7 accuracy: 0.56 
 precision: [0.99158897 0.15070644 0.16666667 0.06650831 0.29       0.44067797
 0.11813187 0.16062176 1.         1.         0.00727729 0.48553055
 0.13667426 1.         0.66666667 0.10990502 0.32352941 0.04878049
 0.00708592] 
 recall: [0.55942615 0.96       0.22608696 0.93333333 0.22137405 0.05496829
 0.61428571 0.84738041 1.         1.         0.76315789 0.73658537
 0.46511628 0.         0.01612903 0.9        0.14864865 0.875
 1.        ] 
 f1: [0.71530032 0.2605156  0.19188192 0.12416851 0.25108225 0.09774436
 0.19815668 0.27005445 1.         1.         0.0144171  0.58527132
 0.21126761 0.         0.03149606 0.19588875 0.2037037  0.09240924
 0.01407212] 
 f1_avg: 0.6697641928498662


Validation Epoch: 7 accuracy: 0.47 
 precision: [0.99652174 0.         0.04761905 0.         0.46666667 0.
 1.         0.096      1.         1.         0.         0.
 0.         1.         1.         1.         1.         1.
 0.        ] 
 recall: [0.4650974  0.         0.05405405 1.         0.175      0.
 0.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 f1: [0.63420033 0.         0.05063291 0.         0.25454545 0.
 0.         0.17518248 1.         1.         0.         0.
 0.         1.         1.         1.         1.         1.
 0.        ] 
 f1_avg: 0.5880607240162977

--- 544.8905436992645 seconds ---

Train Epoch: 8 accuracy: 0.53 
 precision: [0.99315834 0.11870504 0.10061444 0.03484603 0.05486726 0.16176471
 0.05538462 0.14515488 1.         1.         0.0137931  0.43092105
 0.11479945 1.         0.28850856 0.34482759 0.48314607 0.0376914
 0.01313629] 
 recall: [0.52330329 0.99       0.56956522 0.95555556 0.47328244 0.09302326
 0.25714286 0.83257403 1.         1.         0.36842105 0.63902439
 0.64341085 0.         0.9516129  1.         0.29054054 1.
 1.        ] 
 f1: [0.68544171 0.21199143 0.17101828 0.06724003 0.09833466 0.11812081
 0.09113924 0.24721001 1.         1.         0.02659069 0.51473477
 0.19483568 0.         0.44277674 0.51282051 0.3628692  0.07264472
 0.02593193] 
 f1_avg: 0.6437883391952258


Validation Epoch: 8 accuracy: 0.58 
 precision: [0.97685185 0.         1.         0.         1.         0.
 1.         0.12268519 1.         1.         0.         0.
 0.         1.         0.         1.         1.         1.
 1.        ] 
 recall: [0.59943182 0.         0.         1.         0.         0.
 0.         0.98148148 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 f1: [0.74295775 0.         0.         0.         0.         0.
 0.         0.218107   1.         1.         0.         0.
 0.         1.         0.         1.         1.         1.
 1.        ] 
 f1_avg: 0.6842079125016604

--- 621.9616575241089 seconds ---

Train Epoch: 9 accuracy: 0.66 
 precision: [0.99684773 0.24484536 0.14583333 0.12374101 0.25153374 0.35099338
 0.09979633 0.17475728 1.         1.         0.01498127 0.20639148
 0.11363636 0.         0.21340388 0.36885246 0.31690141 0.05714286
 0.04733728] 
 recall: [0.65142542 0.95       0.03043478 0.95555556 0.6259542  0.89640592
 0.7        0.90205011 1.         1.         0.84210526 0.75609756
 0.3875969  0.         0.97580645 1.         0.30405405 0.0625
 1.        ] 
 f1: [0.78794216 0.38934426 0.05035971 0.21910828 0.35886214 0.50446163
 0.17468806 0.29279113 1.         1.         0.02943882 0.32426778
 0.17574692 0.         0.35021708 0.53892216 0.31034483 0.05970149
 0.09039548] 
 f1_avg: 0.7437770957132124


Validation Epoch: 9 accuracy: 0.54 
 precision: [0.99180938 0.05405405 0.10638298 0.         0.14634146 0.
 0.         0.16535433 1.         1.         1.         0.
 0.         1.         0.         1.         1.         1.
 0.        ] 
 recall: [0.54058442 0.13636364 0.13513514 1.         0.3        0.
 0.         0.97222222 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 f1: [0.69976359 0.07741935 0.11904762 0.         0.19672131 0.
 0.         0.28263795 1.         1.         1.         0.
 0.         1.         0.         1.         1.         1.
 0.        ] 
 f1_avg: 0.653292420341103

--- 698.8557703495026 seconds ---

Train Epoch: 10 accuracy: 0.50 
 precision: [0.99954324 0.12804097 0.09041835 0.1255814  0.06565383 0.2
 0.04031765 0.23793787 1.         1.         0.03867403 0.03225806
 0.03581708 0.05438066 0.12552301 0.29865772 0.25376344 0.03259005
 0.0754717 ] 
 recall: [0.48298694 1.         0.29130435 0.9        0.92366412 0.11205074
 0.94285714 0.82004556 1.         1.         0.18421053 0.28780488
 0.86821705 0.94736842 0.96774194 0.98888889 0.7972973  0.59375
 1.        ] 
 f1: [0.65127353 0.22701476 0.13800206 0.22040816 0.12259372 0.14363144
 0.07732865 0.36885246 1.         1.         0.06392694 0.05801377
 0.06879607 0.10285714 0.22222222 0.45876289 0.38499184 0.06178862
 0.14035088] 
 f1_avg: 0.6125705035411029

