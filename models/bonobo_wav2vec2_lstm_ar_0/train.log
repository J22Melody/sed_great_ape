Requirement already satisfied: scikit-learn in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (1.1.2)
Requirement already satisfied: numpy>=1.17.3 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (1.22.3)
Requirement already satisfied: threadpoolctl>=2.0.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (3.1.0)
Requirement already satisfied: joblib>=1.0.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (1.1.0)
Requirement already satisfied: scipy>=1.3.2 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (1.9.1)
Requirement already satisfied: tensorboard in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (2.10.1)
Requirement already satisfied: absl-py>=0.4 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (1.2.0)
Requirement already satisfied: numpy>=1.12.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (1.22.3)
Requirement already satisfied: werkzeug>=1.0.1 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (2.1.2)
Requirement already satisfied: requests<3,>=2.21.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (2.28.1)
Requirement already satisfied: protobuf<3.20,>=3.9.2 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (3.19.4)
Requirement already satisfied: grpcio>=1.24.3 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (1.47.0)
Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (1.8.1)
Requirement already satisfied: google-auth<3,>=1.6.3 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (2.9.1)
Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (0.6.1)
Requirement already satisfied: setuptools>=41.0.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (60.8.1)
Requirement already satisfied: markdown>=2.6.8 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (3.4.1)
Requirement already satisfied: wheel>=0.26 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (0.37.1)
Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (0.4.6)
Requirement already satisfied: six>=1.9.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (1.16.0)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (0.2.8)
Requirement already satisfied: rsa<5,>=3.1.4 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (4.9)
Requirement already satisfied: cachetools<6.0,>=2.0.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (5.2.0)
Requirement already satisfied: requests-oauthlib>=0.7.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard) (1.3.1)
Requirement already satisfied: importlib-metadata>=4.4 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from markdown>=2.6.8->tensorboard) (4.12.0)
Requirement already satisfied: charset-normalizer<3,>=2 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (2.1.1)
Requirement already satisfied: certifi>=2017.4.17 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (2022.9.14)
Requirement already satisfied: idna<4,>=2.5 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (3.4)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (1.26.12)
Requirement already satisfied: zipp>=0.5 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard) (3.8.0)
Requirement already satisfied: pyasn1<0.5.0,>=0.4.6 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard) (0.4.8)
Requirement already satisfied: oauthlib>=3.0.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard) (3.2.0)
Requirement already satisfied: torch in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (1.12.1)
Requirement already satisfied: torchvision in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (0.13.1)
Requirement already satisfied: torchaudio in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (0.12.1)
Requirement already satisfied: typing-extensions in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torch) (4.0.1)
Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torchvision) (9.0.1)
Requirement already satisfied: requests in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torchvision) (2.28.1)
Requirement already satisfied: numpy in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torchvision) (1.22.3)
Requirement already satisfied: certifi>=2017.4.17 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (2022.9.14)
Requirement already satisfied: idna<4,>=2.5 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (3.4)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (1.26.12)
Requirement already satisfied: charset-normalizer<3,>=2 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (2.1.1)
{'name': 'bonobo_wav2vec2_lstm_ar_0', 'data_path': '/home/cluster/zifjia/data/data_bonobo/wav2vec2_split_0', 'test_only': False, 'balance_weights': True, 'model_type': 'lstm', 'model_autoregressive': True, 'n_embedding': 768, 'd_hid': 1024, 'nlayers': 2, 'batch_size': 1, 'n_epoch': 200, 'lr': 0.0002, 'dropout': 0.2, 'patience': 10, 'step_factor': 0.7, 'seed': 0}
cuda
Reading data ...
train, dev, test number of files: 22, 3, 3.
dev files:  ['861', '54', '251']
test files:  ['563', '1328', '1433']
data_all: (33867, 769)
train_data_all: (30975, 769)
Labels in train_data_all:  {0: 28557, 1: 100, 2: 245, 3: 65, 4: 171, 5: 476, 6: 77, 7: 728, 8: 32, 9: 26, 10: 23, 11: 80, 12: 64, 13: 19, 14: 124, 15: 0, 16: 148, 17: 32, 18: 8}
--- 0.9614012241363525 seconds ---
LSTM(
  (lstm): LSTM(787, 1024, num_layers=2, dropout=0.2, bidirectional=True)
  (hidden2tag): Linear(in_features=2048, out_features=19, bias=True)
)
Number of parameters: 40073235

Train Epoch: 1 accuracy: 0.29 
 precision: [9.39814815e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 1.00000000e+00 4.33350667e-04 2.12848799e-01
 0.00000000e+00 1.00000000e+00 1.04058273e-03 0.00000000e+00
 1.00000000e+00 0.00000000e+00 0.00000000e+00 1.00000000e+00
 0.00000000e+00 0.00000000e+00 1.00000000e+00] 
 recall: [0.30566936 0.         0.         0.         0.         0.
 0.06493506 0.45054945 0.         0.         0.08695652 0.
 0.         0.         0.         1.         0.         0.
 0.        ] 
 f1: [4.61302682e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 8.60955661e-04 2.89114147e-01
 0.00000000e+00 0.00000000e+00 2.05655527e-03 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 1.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00] 
 f1_avg: 0.43209069840758313


Validation Epoch: 1 accuracy: 0.10 
 precision: [1.         1.         1.         1.         1.         1.
 1.         0.09608844 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 recall: [0.00110497 0.         1.         0.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1: [0.00220751 0.         1.         0.         1.         1.
 1.         0.17532971 1.         1.         1.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1_avg: 0.01853020395793062

New best val score, save model ...
--- 84.5157744884491 seconds ---

Train Epoch: 2 accuracy: 0.28 
 precision: [0.9295045  0.21774194 1.         1.         1.         1.
 1.         0.0200264  1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 recall: [0.28903596 0.27       0.         0.         0.         0.
 0.         0.6043956  0.         0.         0.         0.
 0.         0.         0.         1.         0.         0.
 0.        ] 
 f1: [0.44095414 0.24107143 0.         0.         0.         0.
 0.         0.03876823 0.         0.         0.         0.
 0.         0.         0.         1.         0.         0.
 0.        ] 
 f1_avg: 0.40822139410550423


Validation Epoch: 2 accuracy: 0.58 
 precision: [0.97614991 0.         1.         1.         1.         1.
 1.         0.19316239 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 recall: [0.63314917 0.         1.         0.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1: [0.76809651 0.         1.         0.         1.         1.
 1.         0.32378223 1.         1.         1.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1_avg: 0.6216777726377631

New best val score, save model ...
--- 163.84745001792908 seconds ---

Train Epoch: 3 accuracy: 0.58 
 precision: [0.98388387 0.06092125 0.58333333 0.04301075 0.51785714 1.
 1.         0.05686678 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 0.29411765] 
 recall: [0.60286445 0.41       0.02857143 0.06153846 0.16959064 0.
 0.         0.98626374 0.         0.         0.         0.
 0.         0.         0.         1.         0.         0.
 0.625     ] 
 f1: [0.74762784 0.10608021 0.05447471 0.05063291 0.25550661 0.
 0.         0.10753332 0.         0.         0.         0.
 0.         0.         0.         1.         0.         0.
 0.4       ] 
 f1_avg: 0.6941865851015376


Validation Epoch: 3 accuracy: 0.67 
 precision: [0.95804196 0.15053763 0.         1.         1.         1.
 1.         0.25409836 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 recall: [0.75690608 0.31818182 1.         0.         1.         1.
 1.         0.82300885 1.         1.         1.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1: [0.84567901 0.20437956 0.         0.         1.         1.
 1.         0.38830898 1.         1.         1.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1_avg: 0.6951666281289524

New best val score, save model ...
--- 243.06191229820251 seconds ---

Train Epoch: 4 accuracy: 0.60 
 precision: [0.98774851 0.07018993 0.20634921 0.02882096 0.04267516 1.
 1.         0.09136469 1.         1.         0.01612903 1.
 0.         0.         0.         1.         1.         1.
 0.01129944] 
 recall: [0.62110866 0.85       0.2122449  0.50769231 0.39181287 0.01260504
 0.         0.97664835 0.         0.         0.34782609 0.
 0.         0.         0.         1.         0.         0.
 0.75      ] 
 f1: [0.7626521  0.12967201 0.20925553 0.05454545 0.07696726 0.02489627
 0.         0.16709753 0.         0.         0.03082852 0.
 0.         0.         0.         1.         0.         0.
 0.02226345] 
 f1_avg: 0.7100688492924692


Validation Epoch: 4 accuracy: 0.65 
 precision: [0.97297297 0.         0.         0.64285714 1.         1.
 1.         0.22933884 1.         1.         0.         1.
 1.         1.         1.         1.         1.         1.
 0.        ] 
 recall: [0.7160221  0.         1.         0.36       1.         1.
 1.         0.98230088 1.         1.         1.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1: [0.82495226 0.         0.         0.46153846 1.         1.
 1.         0.3718593  1.         1.         0.         1.
 1.         1.         1.         0.         1.         1.
 0.        ] 
 f1_avg: 0.6798133874902156

--- 321.9823591709137 seconds ---

Train Epoch: 5 accuracy: 0.59 
 precision: [0.98741419 0.10425532 0.0974026  0.01470588 0.03587444 0.12195122
 0.         0.13545222 0.         1.         0.00572861 1.
 0.12087912 0.4        1.         1.         1.         0.
 0.00463231] 
 recall: [0.60440522 0.98       0.12244898 0.47692308 0.09356725 0.04201681
 0.         0.87225275 0.         0.         0.69565217 0.
 0.515625   0.73684211 0.         1.         0.         0.
 1.        ] 
 f1: [0.74983166 0.18846154 0.1084991  0.02853198 0.05186386 0.0625
 0.         0.2344904  0.         0.         0.01136364 0.
 0.1958457  0.51851852 0.         1.         0.         0.
 0.0092219 ] 
 f1_avg: 0.7003155606015808


Validation Epoch: 5 accuracy: 0.69 
 precision: [0.98732394 1.         1.         1.         1.         1.
 1.         0.23982869 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 recall: [0.77458564 0.         1.         0.         1.         1.
 1.         0.99115044 1.         1.         1.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1: [0.86811146 0.         1.         0.         1.         1.
 1.         0.3862069  1.         1.         1.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1_avg: 0.7045728514727357

New best val score, save model ...
--- 401.20214223861694 seconds ---

Train Epoch: 6 accuracy: 0.60 
 precision: [0.99097607 0.19709544 0.07352941 0.0462963  0.04401544 0.60526316
 0.         0.07838875 0.26495726 0.59259259 0.01258581 1.
 0.06995885 0.13740458 0.31321839 1.         1.         0.0596206
 0.02030457] 
 recall: [0.60759183 0.95       0.02040816 0.76923077 0.33333333 0.19327731
 0.         0.84203297 0.96875    0.61538462 0.47826087 0.0125
 0.265625   0.94736842 0.87903226 1.         0.         0.6875
 1.        ] 
 f1: [0.75331047 0.32646048 0.03194888 0.08733624 0.07776262 0.29299363
 0.         0.14342536 0.41610738 0.60377358 0.0245262  0.02469136
 0.11074919 0.24       0.46186441 1.         0.         0.10972569
 0.039801  ] 
 f1_avg: 0.7076647350435854


Validation Epoch: 6 accuracy: 0.57 
 precision: [0.98763251 0.         0.         1.         1.         0.
 1.         0.20973783 0.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 recall: [0.61767956 0.         1.         0.         1.         1.
 1.         0.99115044 1.         1.         1.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1: [0.76002719 0.         0.         0.         1.         0.
 1.         0.34621329 0.         1.         1.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1_avg: 0.6176267724033331

--- 480.07809352874756 seconds ---

Train Epoch: 7 accuracy: 0.55 
 precision: [0.9919319  0.15217391 0.04505263 0.04865424 0.17419355 0.20200753
 0.03921569 0.12385231 0.14375    0.23076923 0.00455581 0.26923077
 0.06206897 0.16666667 0.18072289 1.         0.5        0.06122449
 0.01822323] 
 recall: [0.54676612 0.7        0.87346939 0.72307692 0.15789474 0.67647059
 0.05194805 0.87087912 0.71875    0.34615385 0.08695652 0.175
 0.140625   1.         0.72580645 1.         0.02027027 0.375
 1.        ] 
 f1: [0.70495282 0.25       0.08568569 0.09117362 0.16564417 0.31111111
 0.04469274 0.21686335 0.23958333 0.27692308 0.00865801 0.21212121
 0.0861244  0.28571429 0.28938907 1.         0.03896104 0.10526316
 0.03579418] 
 f1_avg: 0.6653517394780132


Validation Epoch: 7 accuracy: 0.62 
 precision: [0.99358974 0.         1.         1.         1.         1.
 1.         0.23395445 1.         1.         0.         1.
 1.         1.         1.         1.         1.         1.
 1.        ] 
 recall: [0.68508287 0.         1.         0.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1: [0.81098757 0.         1.         0.         1.         1.
 1.         0.37919463 1.         1.         0.         1.
 1.         1.         1.         0.         1.         1.
 1.        ] 
 f1_avg: 0.6599768456892349

--- 559.1760587692261 seconds ---
