Requirement already satisfied: scikit-learn in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (1.1.2)
Requirement already satisfied: scipy>=1.3.2 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (1.9.1)
Requirement already satisfied: threadpoolctl>=2.0.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (3.1.0)
Requirement already satisfied: numpy>=1.17.3 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (1.22.3)
Requirement already satisfied: joblib>=1.0.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (1.1.0)
Requirement already satisfied: tensorboard in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (2.10.1)
Requirement already satisfied: absl-py>=0.4 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (1.2.0)
Requirement already satisfied: werkzeug>=1.0.1 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (2.1.2)
Requirement already satisfied: grpcio>=1.24.3 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (1.47.0)
Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (0.4.6)
Requirement already satisfied: wheel>=0.26 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (0.37.1)
Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (1.8.1)
Requirement already satisfied: google-auth<3,>=1.6.3 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (2.9.1)
Requirement already satisfied: requests<3,>=2.21.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (2.28.1)
Requirement already satisfied: setuptools>=41.0.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (60.8.1)
Requirement already satisfied: markdown>=2.6.8 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (3.4.1)
Requirement already satisfied: protobuf<3.20,>=3.9.2 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (3.19.4)
Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (0.6.1)
Requirement already satisfied: numpy>=1.12.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (1.22.3)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (0.2.8)
Requirement already satisfied: cachetools<6.0,>=2.0.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (5.2.0)
Requirement already satisfied: rsa<5,>=3.1.4 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (4.9)
Requirement already satisfied: six>=1.9.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (1.16.0)
Requirement already satisfied: requests-oauthlib>=0.7.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard) (1.3.1)
Requirement already satisfied: importlib-metadata>=4.4 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from markdown>=2.6.8->tensorboard) (4.12.0)
Requirement already satisfied: idna<4,>=2.5 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (3.4)
Requirement already satisfied: charset-normalizer<3,>=2 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (2.1.1)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (1.26.12)
Requirement already satisfied: certifi>=2017.4.17 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (2022.9.14)
Requirement already satisfied: zipp>=0.5 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard) (3.8.0)
Requirement already satisfied: pyasn1<0.5.0,>=0.4.6 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard) (0.4.8)
Requirement already satisfied: oauthlib>=3.0.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard) (3.2.0)
Requirement already satisfied: torch in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (1.12.1)
Requirement already satisfied: torchvision in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (0.13.1)
Requirement already satisfied: torchaudio in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (0.12.1)
Requirement already satisfied: typing-extensions in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torch) (4.0.1)
Requirement already satisfied: numpy in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torchvision) (1.22.3)
Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torchvision) (9.0.1)
Requirement already satisfied: requests in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torchvision) (2.28.1)
Requirement already satisfied: charset-normalizer<3,>=2 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (2.1.1)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (1.26.12)
Requirement already satisfied: idna<4,>=2.5 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (3.4)
Requirement already satisfied: certifi>=2017.4.17 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (2022.9.14)
{'name': 'bonobo_wav2vec2_lstm_binary_ar_0', 'data_path': '/home/cluster/zifjia/data/data_bonobo/wav2vec2_split_0', 'test_only': False, 'test_prediction': True, 'test_distribution': True, 'balance_weights': True, 'binary': True, 'model_type': 'lstm', 'model_autoregressive': True, 'n_embedding': 768, 'd_hid': 1024, 'nlayers': 2, 'batch_size': 1, 'n_epoch': 200, 'lr': 0.0002, 'dropout': 0.2, 'patience': 10, 'step_factor': 0.7, 'seed': 0}
cuda
Reading data ...
train, dev, test number of files: 22, 3, 3.
dev files:  ['861', '54', '251']
test files:  ['563', '1328', '1433']
train_data_all: (30975, 769)
Labels in train_data_all:  {0: 28557, 1: 2418}
--- 1.1249992847442627 seconds ---
LSTM(
  (lstm): LSTM(770, 1024, num_layers=2, dropout=0.2, bidirectional=True)
  (hidden2tag): Linear(in_features=2048, out_features=2, bias=True)
)
Number of parameters: 39899138

Train Epoch: 1 accuracy: 0.70 
 precision: [0.94132231 0.12398042] 
 recall: [0.71793256 0.47146402] 
 f1: [0.81458967 0.1963317 ] 
 f1_avg: 0.7663266223077698


Validation Epoch: 1 accuracy: 0.73 
 precision: [0.99166667 0.4627383 ] 
 recall: [0.65745856 0.98161765] 
 f1: [0.79069767 0.62897527] 
 f1_avg: 0.7533242713964681

New best val score, save model ...
--- 83.82184433937073 seconds ---

Train Epoch: 2 accuracy: 0.70 
 precision: [0.98691363 0.19429189] 
 recall: [0.68662675 0.89247312] 
 f1: [0.80982963 0.31911275] 
 f1_avg: 0.771522824280755


Validation Epoch: 2 accuracy: 0.77 
 precision: [0.9921875 0.4972067] 
 recall: [0.70165746 0.98161765] 
 f1: [0.82200647 0.66007417] 
 f1_avg: 0.7845845630062277

New best val score, save model ...
--- 162.49857831001282 seconds ---

Train Epoch: 3 accuracy: 0.79 
 precision: [0.99291829 0.26084949] 
 recall: [0.77574675 0.93465674] 
 f1: [0.87099945 0.40786862] 
 f1_avg: 0.8348460885844196


Validation Epoch: 3 accuracy: 0.86 
 precision: [0.96954315 0.63753213] 
 recall: [0.8441989  0.91176471] 
 f1: [0.90253987 0.75037821] 
 f1_avg: 0.8673759191425553

New best val score, save model ...
--- 240.9766616821289 seconds ---

Train Epoch: 4 accuracy: 0.83 
 precision: [0.98836723 0.30238802] 
 recall: [0.82711769 0.88502895] 
 f1: [0.90058145 0.45076356] 
 f1_avg: 0.8654673374360687


Validation Epoch: 4 accuracy: 0.93 
 precision: [0.94600432 0.88446215] 
 recall: [0.9679558  0.81617647] 
 f1: [0.95685418 0.84894837] 
 f1_avg: 0.9319175777956841

New best val score, save model ...
--- 319.6094353199005 seconds ---

Train Epoch: 5 accuracy: 0.88 
 precision: [0.98171064 0.36914914] 
 recall: [0.88342613 0.80562448] 
 f1: [0.9299788  0.50630279] 
 f1_avg: 0.8969054029369835


Validation Epoch: 5 accuracy: 0.92 
 precision: [0.95275591 0.79861111] 
 recall: [0.9359116  0.84558824] 
 f1: [0.94425864 0.82142857] 
 f1_avg: 0.9158731015699728

--- 397.6610584259033 seconds ---

Train Epoch: 6 accuracy: 0.90 
 precision: [0.9854034  0.44205262] 
 recall: [0.91014462 0.8407775 ] 
 f1: [0.94628001 0.57944991] 
 f1_avg: 0.9176441721098465


Validation Epoch: 6 accuracy: 0.85 
 precision: [0.98798398 0.61448598] 
 recall: [0.81767956 0.96691176] 
 f1: [0.89480048 0.75142857] 
 f1_avg: 0.8616678072687296

--- 475.7789521217346 seconds ---

Train Epoch: 7 accuracy: 0.85 
 precision: [0.99548766 0.3386127 ] 
 recall: [0.84207025 0.95492142] 
 f1: [0.91237456 0.49994587] 
 f1_avg: 0.8801791549656487


Validation Epoch: 7 accuracy: 0.87 
 precision: [0.98573281 0.64285714] 
 recall: [0.83977901 0.95955882] 
 f1: [0.90692124 0.7699115 ] 
 f1_avg: 0.8752588380237025

--- 553.9695909023285 seconds ---

Train Epoch: 8 accuracy: 0.88 
 precision: [0.99686659 0.38474186] 
 recall: [0.86896383 0.96774194] 
 f1: [0.92853134 0.55058824] 
 f1_avg: 0.8990279826829813


Validation Epoch: 8 accuracy: 0.88 
 precision: [0.97062424 0.68888889] 
 recall: [0.87624309 0.91176471] 
 f1: [0.92102207 0.78481013] 
 f1_avg: 0.889544031770922

--- 632.1181921958923 seconds ---

Train Epoch: 9 accuracy: 0.91 
 precision: [0.99684737 0.47049345] 
 recall: [0.90793851 0.96608768] 
 f1: [0.95031796 0.63280509] 
 f1_avg: 0.9255319655698365


Validation Epoch: 9 accuracy: 0.91 
 precision: [0.94960806 0.79929577] 
 recall: [0.93701657 0.83455882] 
 f1: [0.9432703  0.81654676] 
 f1_avg: 0.9139849967939361

--- 710.2037754058838 seconds ---

Train Epoch: 10 accuracy: 0.93 
 precision: [0.99130856 0.52435805] 
 recall: [0.93059495 0.90363937] 
 f1: [0.95999278 0.66362946] 
 f1_avg: 0.9368577794471505


Validation Epoch: 10 accuracy: 0.82 
 precision: [0.98597475 0.56465517] 
 recall: [0.77679558 0.96323529] 
 f1: [0.86897404 0.71195652] 
 f1_avg: 0.8326879200914649

--- 788.2735130786896 seconds ---

Train Epoch: 11 accuracy: 0.86 
 precision: [0.9976313 0.3636924] 
 recall: [0.85541198 0.97601323] 
 f1: [0.92106404 0.52992029] 
 f1_avg: 0.8905302054312811


Validation Epoch: 11 accuracy: 0.89 
 precision: [0.88989899 0.87165775] 
 recall: [0.97348066 0.59926471] 
 f1: [0.9298153  0.71023965] 
 f1_avg: 0.8790722470598189

--- 866.4232563972473 seconds ---

Train Epoch: 12 accuracy: 0.91 
 precision: [0.98844063 0.45209581] 
 recall: [0.91028469 0.87427626] 
 f1: [0.94775412 0.59599662] 
 f1_avg: 0.9202948901019378


Validation Epoch: 12 accuracy: 0.88 
 precision: [0.88449848 0.83157895] 
 recall: [0.96464088 0.58088235] 
 f1: [0.92283298 0.68398268] 
 f1_avg: 0.8676356311159023

--- 944.5701329708099 seconds ---

Train Epoch: 13 accuracy: 0.93 
 precision: [0.99360638 0.5125399 ] 
 recall: [0.92513219 0.92969396] 
 f1: [0.95814746 0.66078777] 
 f1_avg: 0.9349346872038706


Validation Epoch: 13 accuracy: 0.80 
 precision: [0.79575597 0.89130435] 
 recall: [0.99447514 0.15073529] 
 f1: [0.88408644 0.25786164] 
 f1_avg: 0.7393683913398353

--- 1022.8815155029297 seconds ---

Train Epoch: 14 accuracy: 0.92 
 precision: [0.9730142  0.48663568] 
 recall: [0.93812375 0.69272126] 
 f1: [0.95525049 0.57167235] 
 f1_avg: 0.9253072479512947


Validation Epoch: 14 accuracy: 0.88 
 precision: [0.88956434 0.85789474] 
 recall: [0.97016575 0.59926471] 
 f1: [0.92811839 0.70562771] 
 f1_avg: 0.8767016837791966

--- 1101.085545539856 seconds ---

Train Epoch: 15 accuracy: 0.92 
 precision: [0.99117967 0.50392428] 
 recall: [0.924747   0.90281224] 
 f1: [0.95681159 0.64681481] 
 f1_avg: 0.9326123298748795


Validation Epoch: 15 accuracy: 0.84 
 precision: [0.83600377 0.84482759] 
 recall: [0.9801105  0.36029412] 
 f1: [0.90233978 0.50515464] 
 f1_avg: 0.8105518770708879

--- 1179.091073513031 seconds ---

Train Epoch: 16 accuracy: 0.94 
 precision: [0.99191434 0.56529563] 
 recall: [0.9407851  0.90942928] 
 f1: [0.96567341 0.69720989] 
 f1_avg: 0.9447163567618442


Validation Epoch: 16 accuracy: 0.78 
 precision: [0.99539171 0.51140684] 
 recall: [0.7160221  0.98897059] 
 f1: [0.83290488 0.67418546] 
 f1_avg: 0.7962254600032043

--- 1257.2312214374542 seconds ---
