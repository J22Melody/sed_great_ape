Requirement already satisfied: scikit-learn in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (1.1.2)
Requirement already satisfied: numpy>=1.17.3 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (1.22.3)
Requirement already satisfied: threadpoolctl>=2.0.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (3.1.0)
Requirement already satisfied: scipy>=1.3.2 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (1.9.1)
Requirement already satisfied: joblib>=1.0.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from scikit-learn) (1.1.0)
Requirement already satisfied: tensorboard in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (2.10.1)
Requirement already satisfied: setuptools>=41.0.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (60.8.1)
Requirement already satisfied: werkzeug>=1.0.1 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (2.1.2)
Requirement already satisfied: grpcio>=1.24.3 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (1.47.0)
Requirement already satisfied: wheel>=0.26 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (0.37.1)
Requirement already satisfied: markdown>=2.6.8 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (3.4.1)
Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (0.6.1)
Requirement already satisfied: absl-py>=0.4 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (1.2.0)
Requirement already satisfied: numpy>=1.12.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (1.22.3)
Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (1.8.1)
Requirement already satisfied: requests<3,>=2.21.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from tensorboard) (2.28.1)
Requirement already satisfied: google-auth<3,>=1.6.3 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (2.9.1)
Requirement already satisfied: protobuf<3.20,>=3.9.2 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (3.19.4)
Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from tensorboard) (0.4.6)
Requirement already satisfied: cachetools<6.0,>=2.0.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (5.2.0)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (0.2.8)
Requirement already satisfied: rsa<5,>=3.1.4 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (4.9)
Requirement already satisfied: six>=1.9.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard) (1.16.0)
Requirement already satisfied: requests-oauthlib>=0.7.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard) (1.3.1)
Requirement already satisfied: importlib-metadata>=4.4 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from markdown>=2.6.8->tensorboard) (4.12.0)
Requirement already satisfied: idna<4,>=2.5 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (3.4)
Requirement already satisfied: charset-normalizer<3,>=2 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (2.1.1)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (1.26.12)
Requirement already satisfied: certifi>=2017.4.17 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests<3,>=2.21.0->tensorboard) (2022.9.14)
Requirement already satisfied: zipp>=0.5 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard) (3.8.0)
Requirement already satisfied: pyasn1<0.5.0,>=0.4.6 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard) (0.4.8)
Requirement already satisfied: oauthlib>=3.0.0 in /net/cephfs/home/zifjia/.local/lib/python3.8/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard) (3.2.0)
Requirement already satisfied: torch in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (1.12.1)
Requirement already satisfied: torchvision in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (0.13.1)
Requirement already satisfied: torchaudio in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (0.12.1)
Requirement already satisfied: typing-extensions in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torch) (4.0.1)
Requirement already satisfied: pillow!=8.3.*,>=5.3.0 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torchvision) (9.0.1)
Requirement already satisfied: numpy in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torchvision) (1.22.3)
Requirement already satisfied: requests in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from torchvision) (2.28.1)
Requirement already satisfied: certifi>=2017.4.17 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (2022.9.14)
Requirement already satisfied: idna<4,>=2.5 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (3.4)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (1.26.12)
Requirement already satisfied: charset-normalizer<3,>=2 in /net/cephfs/data/zifjia/condaenvs/audio_clf/lib/python3.8/site-packages (from requests->torchvision) (2.1.1)
{'name': 'bonobo_wav2vec2_lstm_binary_ar_42', 'data_path': '/home/cluster/zifjia/data/data_bonobo/wav2vec2_split_42', 'test_only': False, 'test_prediction': True, 'test_distribution': True, 'balance_weights': True, 'binary': True, 'model_type': 'lstm', 'model_autoregressive': True, 'n_embedding': 768, 'd_hid': 1024, 'nlayers': 2, 'batch_size': 1, 'n_epoch': 200, 'lr': 0.0002, 'dropout': 0.2, 'patience': 10, 'step_factor': 0.7, 'seed': 42}
cuda
Reading data ...
train, dev, test number of files: 22, 3, 3.
dev files:  ['1758', '861', '2100']
test files:  ['960', '1398', '852']
train_data_all: (29950, 769)
Labels in train_data_all:  {0: 27185, 1: 2765}
--- 1.0161793231964111 seconds ---
LSTM(
  (lstm): LSTM(770, 1024, num_layers=2, dropout=0.2, bidirectional=True)
  (hidden2tag): Linear(in_features=2048, out_features=2, bias=True)
)
Number of parameters: 39899138

Train Epoch: 1 accuracy: 0.76 
 precision: [0.93910482 0.19150708] 
 recall: [0.78569064 0.49909584] 
 f1: [0.85557492 0.27680273] 
 f1_avg: 0.8021423587478578


Validation Epoch: 1 accuracy: 0.61 
 precision: [0.98219178 0.176     ] 
 recall: [0.58198052 0.89430894] 
 f1: [0.73088685 0.29411765] 
 f1_avg: 0.6912391660344017

New best val score, save model ...
--- 81.3582181930542 seconds ---

Train Epoch: 2 accuracy: 0.74 
 precision: [0.97911548 0.24375   ] 
 recall: [0.73294096 0.84629295] 
 f1: [0.83832965 0.37848767] 
 f1_avg: 0.7958767941186582


Validation Epoch: 2 accuracy: 0.61 
 precision: [0.99165508 0.18396226] 
 recall: [0.57873377 0.95121951] 
 f1: [0.73090723 0.3083004 ] 
 f1_avg: 0.6925451308917134

New best val score, save model ...
--- 157.58609795570374 seconds ---

Train Epoch: 3 accuracy: 0.74 
 precision: [0.99288821 0.25237866] 
 recall: [0.71384955 0.94972875] 
 f1: [0.83055853 0.39878512] 
 f1_avg: 0.790696975835691


Validation Epoch: 3 accuracy: 0.71 
 precision: [0.98675115 0.22895277] 
 recall: [0.69521104 0.90650407] 
 f1: [0.81571429 0.36557377] 
 f1_avg: 0.7748528219708427

New best val score, save model ...
--- 233.7545874118805 seconds ---

Train Epoch: 4 accuracy: 0.83 
 precision: [0.99317208 0.34632723] 
 recall: [0.81864999 0.94466546] 
 f1: [0.8975057  0.50684001] 
 f1_avg: 0.8614392316516771


Validation Epoch: 4 accuracy: 0.73 
 precision: [0.98923513 0.24021164] 
 recall: [0.7086039  0.92276423] 
 f1: [0.82572712 0.38119228] 
 f1_avg: 0.7853745125368554

New best val score, save model ...
--- 309.8974521160126 seconds ---

Train Epoch: 5 accuracy: 0.84 
 precision: [0.99503304 0.35846507] 
 recall: [0.82534486 0.95949367] 
 f1: [0.90228013 0.52193586] 
 f1_avg: 0.8671665444997703


Validation Epoch: 5 accuracy: 0.84 
 precision: [0.9497576  0.29931973] 
 recall: [0.87459416 0.53658537] 
 f1: [0.91062751 0.38427948] 
 f1_avg: 0.8628483148402971

New best val score, save model ...
--- 386.0113823413849 seconds ---

Train Epoch: 6 accuracy: 0.89 
 precision: [0.98161086 0.4573751 ] 
 recall: [0.89931948 0.83435805] 
 f1: [0.93866503 0.5908567 ] 
 f1_avg: 0.906555178163632


Validation Epoch: 6 accuracy: 0.84 
 precision: [0.96115174 0.30842912] 
 recall: [0.85349026 0.65447154] 
 f1: [0.90412726 0.41927083] 
 f1_avg: 0.8601144599553261

--- 461.6238524913788 seconds ---

Train Epoch: 7 accuracy: 0.90 
 precision: [0.98909588 0.48930744] 
 recall: [0.90424867 0.90198915] 
 f1: [0.94477113 0.63444416] 
 f1_avg: 0.9161215774130732


Validation Epoch: 7 accuracy: 0.81 
 precision: [0.96133899 0.27843803] 
 recall: [0.82751623 0.66666667] 
 f1: [0.88942203 0.39281437] 
 f1_avg: 0.8443425140929655

--- 537.3462090492249 seconds ---

Train Epoch: 8 accuracy: 0.92 
 precision: [0.98764509 0.54046307] 
 recall: [0.92334008 0.88643761] 
 f1: [0.95441065 0.67150685] 
 f1_avg: 0.9282928167081602


Validation Epoch: 8 accuracy: 0.71 
 precision: [0.98781903 0.22819473] 
 recall: [0.6911526  0.91463415] 
 f1: [0.81327603 0.36525974] 
 f1_avg: 0.7726073896674663

--- 613.1788594722748 seconds ---

Train Epoch: 9 accuracy: 0.87 
 precision: [0.9954336  0.42181299] 
 recall: [0.86602906 0.96094033] 
 f1: [0.92623338 0.58627538] 
 f1_avg: 0.894848273488038


Validation Epoch: 9 accuracy: 0.75 
 precision: [0.97006303 0.23449132] 
 recall: [0.74959416 0.76829268] 
 f1: [0.84569597 0.35931559] 
 f1_avg: 0.8015448364486569

--- 688.9140257835388 seconds ---

Train Epoch: 10 accuracy: 0.89 
 precision: [0.99616052 0.46648045] 
 recall: [0.88758507 0.96636528] 
 f1: [0.93874375 0.62922407] 
 f1_avg: 0.9101687282739626


Validation Epoch: 10 accuracy: 0.81 
 precision: [0.9632107 0.273906 ] 
 recall: [0.81818182 0.68699187] 
 f1: [0.88479263 0.39165701] 
 f1_avg: 0.8400282866507506

--- 764.7093689441681 seconds ---

Train Epoch: 11 accuracy: 0.93 
 precision: [0.9945503  0.59090909] 
 recall: [0.93312489 0.94972875] 
 f1: [0.96285893 0.72853378] 
 f1_avg: 0.9412259087698909


Validation Epoch: 11 accuracy: 0.83 
 precision: [0.98028846 0.32539683] 
 recall: [0.82751623 0.83333333] 
 f1: [0.89744718 0.46803653] 
 f1_avg: 0.8584674706480809

--- 840.4293193817139 seconds ---

Train Epoch: 12 accuracy: 0.92 
 precision: [0.99471535 0.52956557] 
 recall: [0.9139599 0.9522604] 
 f1: [0.95262926 0.68062557] 
 f1_avg: 0.9275177320543885


Validation Epoch: 12 accuracy: 0.79 
 precision: [0.9604056  0.25665102] 
 recall: [0.80722403 0.66666667] 
 f1: [0.87717751 0.37062147] 
 f1_avg: 0.8311949305279683

--- 916.1402950286865 seconds ---

Train Epoch: 13 accuracy: 0.91 
 precision: [0.98519515 0.5100256 ] 
 recall: [0.91550487 0.86473779] 
 f1: [0.9490724  0.64162082] 
 f1_avg: 0.9206883034224881


Validation Epoch: 13 accuracy: 0.80 
 precision: [0.95394737 0.25429553] 
 recall: [0.82386364 0.60162602] 
 f1: [0.88414634 0.35748792] 
 f1_avg: 0.8363389720853731

--- 991.9865033626556 seconds ---

Train Epoch: 14 accuracy: 0.93 
 precision: [0.99532969 0.56511529] 
 recall: [0.92506897 0.95732369] 
 f1: [0.95891403 0.71069942] 
 f1_avg: 0.9359987285326038


Validation Epoch: 14 accuracy: 0.81 
 precision: [0.9509032  0.25408348] 
 recall: [0.83319805 0.56910569] 
 f1: [0.88816786 0.35131744] 
 f1_avg: 0.839435309385699

--- 1067.7005410194397 seconds ---

Train Epoch: 15 accuracy: 0.94 
 precision: [0.99423654 0.61273706] 
 recall: [0.93915762 0.94647378] 
 f1: [0.96591253 0.74388857] 
 f1_avg: 0.9454151599259348


Validation Epoch: 15 accuracy: 0.83 
 precision: [0.9443217  0.26845638] 
 recall: [0.86728896 0.48780488] 
 f1: [0.90416755 0.34632035] 
 f1_avg: 0.8535290198456262

--- 1143.6167151927948 seconds ---

Train Epoch: 16 accuracy: 0.95 
 precision: [0.9955397  0.63594912] 
 recall: [0.94419717 0.95840868] 
 f1: [0.96918894 0.76457011] 
 f1_avg: 0.9502984241428004


Validation Epoch: 16 accuracy: 0.81 
 precision: [0.94884793 0.25      ] 
 recall: [0.83563312 0.54878049] 
 f1: [0.88864912 0.34351145] 
 f1_avg: 0.8391642939975905

--- 1219.423668384552 seconds ---
